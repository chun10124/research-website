"use strict";(globalThis.webpackChunkresearch=globalThis.webpackChunkresearch||[]).push([[586],{9929:(e,t,s)=>{s.r(t),s.d(t,{default:()=>h});var n=s(6540),r=s(1656);const i="https://corsproxy.io/?";var o=s(4848);const l={border:"1px solid #ddd",padding:"15px",borderRadius:"8px",background:"#fff"},a={width:"100%",borderCollapse:"collapse",textAlign:"right",fontSize:"13px"},d=()=>{const[e,t]=(0,n.useState)("2330"),[s,r]=(0,n.useState)(null),[d,h]=(0,n.useState)(!1);return(0,o.jsxs)("div",{style:{padding:"20px",fontFamily:"sans-serif"},children:[(0,o.jsx)("h2",{children:"\ud83d\udcca \u5168\u7dad\u5ea6\u6578\u64da\u6838\u5c0d (\u542b\u539f\u59cb\u6301\u80a1)"}),(0,o.jsx)("input",{value:e,onChange:e=>t(e.target.value),style:{padding:"8px"}}),(0,o.jsx)("button",{onClick:async()=>{h(!0);const t=await(async(e,t=()=>{})=>{const s="2024-10-01",n=(t,s)=>{const n=new URLSearchParams({dataset:t,data_id:e,start_date:s,token:"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkYXRlIjoiMjAyNS0xMi0xNCAxNzowNzo1MyIsInVzZXJfaWQiOiJjaHVuMTAxMjQiLCJpcCI6IjYxLjIyOC43Ni4yMDYifQ.mSi9H6Lrus7e_wkaNxlYd6OoFmh79NQoQ7pZajx166s"});return`${i}${encodeURIComponent(`https://api.finmindtrade.com/api/v4/data?${n.toString()}`)}`};try{t(`\ud83d\udce1 [${e}] \u6b63\u5728\u5c0d\u63a5 TaiwanStockShareholding \u8cc7\u6599\u5eab...`);const[r,o,l,a,d]=await Promise.all([fetch(n("TaiwanStockPrice",s)).then(e=>e.json()),fetch(n("TaiwanStockInstitutionalInvestorsBuySell",s)).then(e=>e.json()),fetch(n("TaiwanStockShareholding",s)).then(e=>e.json()),fetch(n("TaiwanStockMonthRevenue","2023-01-01")).then(e=>e.json()),fetch(`${i}${encodeURIComponent("https://openapi.twse.com.tw/v1/fund/MI_QFIIS_sort_20")}`).then(e=>e.json())]),h=(a.data||[]).map(e=>Math.round((e.revenue||0)/1e3)).reverse(),c=h.map((e,t)=>{const s=h[t+12];return s?parseFloat(((e-s)/s*100).toFixed(2)):0}),x=(o.data||[]).filter(e=>"Foreign_Investor"===e.name||"\u5916\u8cc7"===e.name).reverse().map(e=>Math.round(((e.buy||0)-(e.sell||0))/1e3)),j=l.data||[],p=j.map(e=>{const t=e.ForeignInvestmentShares||0;return Math.round(t/1e3)}).reverse(),y=j.map((e,t)=>{const s=j.length-1-t,n=p[s],r=p[s+22];return{...e,sharesInLot:n,monthlyGrowth:r&&r>0?((n-r)/r*100).toFixed(2):"0.00"}}).reverse(),u=p[0]||0,g=p[Math.min(22,p.length-1)]||0,m=g>0?(u-g)/g:0,f=r.data||[],v=f.map(e=>e.close).reverse();return{code:e,name:d.find(t=>t.StockNo===e)?.StockName||f[0]?.stock_name||e,currentPrice:v[0]||0,currentForeignShares:p[0]||0,lastMonthForeignShares:p[Math.min(22,p.length-1)]||0,ownershipGrowth:(100*m).toFixed(2),isOwnershipAlert:m>=.2,dailyHoldings:y,history:{price:v,foreign:x,revenueRaw:h,revenueYoY:c}}}catch(r){return t(`\u274c \u932f\u8aa4: ${r.message}`),null}})(e);r(t),h(!1)},disabled:d,style:{marginLeft:"10px",padding:"8px 16px"},children:d?"\u57f7\u884c\u4e2d...":"\u540c\u6b65\u6240\u6709\u8cc7\u6599"}),s&&(0,o.jsxs)("div",{style:{marginTop:"20px",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[(0,o.jsxs)("section",{style:l,children:[(0,o.jsx)("h4",{style:{color:"#d9534f"},children:"\ud83d\udccd \u6bcf\u65e5\u6301\u80a1\u76e3\u63a7 (\u76ee\u6a19\uff1a\u6708\u589e 20%)"}),(0,o.jsxs)("div",{style:{maxHeight:"300px",overflowY:"auto"},children:[(0,o.jsxs)("table",{style:a,children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{style:{background:"#eee"},children:[(0,o.jsx)("th",{children:"\u65e5\u671f"}),(0,o.jsx)("th",{children:"\u5916\u8cc7\u7e3d\u6301\u80a1 (\u5f35)"}),(0,o.jsx)("th",{children:"\u6708\u589e\u7387 %"})]})}),(0,o.jsx)("tbody",{children:s.dailyHoldings.slice(0,15).map((e,t)=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:e.date}),(0,o.jsxs)("td",{style:{fontWeight:"bold"},children:[e.sharesInLot?.toLocaleString()," \u5f35"]}),(0,o.jsxs)("td",{style:{color:parseFloat(e.monthlyGrowth)>=20?"red":"inherit",fontWeight:parseFloat(e.monthlyGrowth)>=20?"bold":"normal"},children:[e.monthlyGrowth,"%"]})]},t))})]}),(0,o.jsx)("div",{style:{fontSize:"12px",color:"#666",marginTop:"10px"},children:"\u8a3b\uff1a\u6708\u589e\u7387\u662f\u4ee5\u6700\u65b0\u6301\u80a1\u5c0d\u6bd4 22 \u500b\u4ea4\u6613\u65e5\u524d\u4e4b\u5f35\u6578 [cite: 2025-12-14]\u3002"})]})]}),(0,o.jsxs)("section",{style:l,children:[(0,o.jsx)("h4",{style:{color:"#5cb85c"},children:"\ud83e\uddfe \u71df\u6536\u6838\u5c0d (\u5343\u5143 / YoY)"}),(0,o.jsx)("div",{style:{maxHeight:"300px",overflowY:"auto"},children:(0,o.jsxs)("table",{style:a,children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{style:{background:"#eee"},children:[(0,o.jsx)("th",{children:"\u6708\u4efd"}),(0,o.jsx)("th",{children:"\u91d1\u984d (\u5343\u5143)"}),(0,o.jsx)("th",{children:"\u81ea\u7b97 YoY%"})]})}),(0,o.jsx)("tbody",{children:s.history.revenueRaw.slice(0,12).map((e,t)=>(0,o.jsxs)("tr",{children:[(0,o.jsxs)("td",{children:["M-",t]}),(0,o.jsx)("td",{children:e.toLocaleString()}),(0,o.jsxs)("td",{children:[s.history.revenueYoY[t],"%"]})]},t))})]})})]}),(0,o.jsxs)("section",{style:{...l,gridColumn:"span 2"},children:[(0,o.jsx)("h4",{style:{color:"#007bff"},children:"\ud83d\udcb0 \u884c\u60c5\u8207\u8cb7\u8ce3\u8d85 (20D/10D \u57fa\u790e)"}),(0,o.jsx)("div",{style:{display:"flex",gap:"20px"},children:(0,o.jsxs)("table",{style:a,children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{style:{background:"#eee"},children:[(0,o.jsx)("th",{children:"\u5929\u6578"}),(0,o.jsx)("th",{children:"\u6536\u76e4\u50f9"}),(0,o.jsx)("th",{children:"\u5916\u8cc7\u8cb7\u8ce3 (\u5f35)"})]})}),(0,o.jsx)("tbody",{children:s.history.price.slice(0,10).map((e,t)=>(0,o.jsxs)("tr",{children:[(0,o.jsxs)("td",{children:["D-",t]}),(0,o.jsx)("td",{children:e}),(0,o.jsx)("td",{style:{color:s.history.foreign[t]>=0?"red":"green"},children:s.history.foreign[t]})]},t))})]})})]})]})]})};function h(){return(0,o.jsx)(r.A,{title:"\u80a1\u5e02 API \u6e2c\u8a66",description:"\u6e2c\u8a66 FinMind \u6578\u64da\u6293\u53d6\u8207\u52a0\u901f\u5ea6\u904b\u7b97",children:(0,o.jsxs)("main",{style:{padding:"2rem",maxWidth:"800px",margin:"0 auto"},children:[(0,o.jsx)("h1",{children:"\ud83d\udcca \u7cfb\u7d71\u6838\u5fc3\u6e2c\u8a66"}),(0,o.jsx)("p",{children:"\u6b64\u9801\u9762\u7528\u65bc\u9a57\u8b49\u7b2c\u4e8c\u968e\u6bb5\u7684 API \u4e32\u63a5\u8207\u6578\u64da\u904b\u7b97\u908f\u8f2f\u3002"}),(0,o.jsx)("hr",{}),(0,o.jsx)(d,{})]})})}}}]);