"use strict";(globalThis.webpackChunkresearch=globalThis.webpackChunkresearch||[]).push([[540],{862:(e,t,n)=>{n.d(t,{A:()=>d});var o=n(6540),s=n(9410),a=n(8185),r=n(2294),i=n(5629),l=n(4848);const c=["#FFE5B4","#E1F5FE","#F3E5F5","#E8F5E9","#FFF3E0","#FCE4EC"];const d=function(){const[e,t]=(0,o.useState)([]),[n,d]=(0,o.useState)({id:"",content:"",tags:"",color:c[0]}),[u,m]=(0,o.useState)(null),[h,g]=(0,o.useState)(""),[p,A]=(0,o.useState)(""),[f,x]=(0,o.useState)("ALL"),[b,j]=(0,o.useState)(null);(0,o.useEffect)(()=>{const e=(0,a.aQ)(r.FO,e=>{if(e.exists()){const n=e.data().notes||[];t(n.sort((e,t)=>(t.createdAt||0)-(e.createdAt||0))),console.log("\u767d\u677f\u8cc7\u6599\u5df2\u5f9e Firestore \u8f09\u5165\u4e26\u5373\u6642\u540c\u6b65\u3002")}else console.log("Firestore \u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u5f9e\u7a7a\u767d\u767d\u677f\u958b\u59cb\u3002"),t([])},e=>{console.error("Firestore \u76e3\u807d\u5931\u6557:",e)});return()=>e()},[]);const v=async e=>{try{const n=e.sort((e,t)=>(t.createdAt||0)-(e.createdAt||0));t(n),await(0,a.BN)(r.FO,{notes:e}),console.log("\u767d\u677f\u8cc7\u6599\u5df2\u6210\u529f\u5beb\u5165 Firestore\u3002")}catch(n){console.error("\u5beb\u5165 Firestore \u5931\u6557:",n),alert("\u8b66\u544a\uff1a\u8cc7\u6599\u5beb\u5165\u96f2\u7aef\u5931\u6557\uff0c\u8acb\u6aa2\u67e5\u7db2\u8def\u9023\u7dda\u3002")}},N=(0,o.useMemo)(()=>{const t=new Set;return e.forEach(e=>{e.tags&&e.tags.split(/[\s,]+/).forEach(e=>{const n=e.trim();n&&t.add(n)})}),Array.from(t).sort()},[e]),_=(0,o.useMemo)(()=>{let t=e.filter(e=>!e.completed);if(h.trim()){const e=h.trim().toLowerCase();t=t.filter(t=>t.content.toLowerCase().includes(e)||t.tags&&t.tags.toLowerCase().includes(e))}if(p&&(t=t.filter(e=>e.tags&&e.tags.split(/[\s,]+/).some(e=>e.trim()===p))),"ALL"!==f){const e=Date.now();let n=0;switch(f){case"TODAY":n=(new Date).setHours(0,0,0,0);break;case"WEEK":n=e-6048e5;break;case"MONTH":n=e-2592e6;break;case"QUARTER":n=e-7776e6;break;case"YEAR":n=e-31536e6}t=t.filter(e=>(e.createdAt||0)>=n)}return t.sort((e,t)=>(t.createdAt||0)-(e.createdAt||0))},[e,h,p,f]),y=e=>{const{name:t,value:n}=e.target;d(e=>({...e,[t]:n}))},w=e=>{if(!e)return"";const t=new Date(e);return`${t.toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"})} ${t.toLocaleTimeString("zh-TW",{hour:"2-digit",minute:"2-digit",hour12:!1})}`},C=(e,t)=>{if(!t||!t.trim())return e;const n=t.trim().toLowerCase(),o=e.toLowerCase(),s=[];let a=0,r=o.indexOf(n,a),c=0;for(;-1!==r;)r>a&&s.push(e.substring(a,r)),s.push((0,l.jsx)("span",{className:i.A.highlight,style:{backgroundColor:"#ffd700",color:"#000",padding:"2px 4px",borderRadius:"3px",fontWeight:"700",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.3)",border:"1px solid rgba(0, 0, 0, 0.2)",display:"inline-block",position:"relative",zIndex:10},children:e.substring(r,r+t.length)},"highlight-"+c++)),a=r+t.length,r=o.indexOf(n,a);return a<e.length&&s.push(e.substring(a)),s.length>0?s:e},S=(0,o.useMemo)(()=>e.filter(e=>e.completed).length,[e]);return(0,l.jsxs)("div",{className:i.A.whiteboardContainer,children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[(0,l.jsx)("h2",{children:u?"\u7de8\u8f2f\u4fbf\u5229\u8cbc":"\u767d\u677f"}),S>0&&(0,l.jsxs)("button",{onClick:()=>{window.location.href="/research-website/completed-notes"},className:i.A.completedBtn,children:["\u5df2\u5b8c\u6210 (",S,")"]})]}),(0,l.jsxs)("div",{className:i.A.mainLayout,children:[(0,l.jsxs)("div",{className:i.A.leftSidebar,children:[(0,l.jsxs)("form",{onSubmit:t=>{if(t.preventDefault(),!n.content.trim())return void alert("\u8acb\u8f38\u5165\u4fbf\u5229\u8cbc\u5167\u5bb9\uff01");const o=n.tags.trim().split(/\s+/).filter(e=>e).join(" "),a={...n,tags:o,createdAt:u&&e.find(e=>e.id===u)?.createdAt||Date.now(),updatedAt:Date.now()};let r;if(u)r=e.map(e=>e.id===u?{...a,id:u}:e),m(null);else{r=[{...a,id:(0,s.A)()},...e]}v(r),d({id:"",content:"",tags:"",color:c[0]})},className:i.A.formContainer,children:[(0,l.jsx)("h3",{className:i.A.sectionTitle,children:u?"\u7de8\u8f2f\u4fbf\u5229\u8cbc":"\u65b0\u589e\u4fbf\u5229\u8cbc"}),(0,l.jsx)("div",{className:i.A.formRow,children:(0,l.jsx)("textarea",{name:"content",value:n.content,onChange:y,placeholder:"\u8f38\u5165\u4fbf\u5229\u8cbc\u5167\u5bb9...",required:!0,rows:"4",className:i.A.contentInput})}),(0,l.jsx)("div",{className:i.A.formRow,children:(0,l.jsx)("input",{type:"text",name:"tags",value:n.tags,onChange:y,placeholder:"\u6a19\u7c64\uff08\u7528\u7a7a\u683c\u5206\u9694\uff09",className:i.A.tagsInput})}),(0,l.jsx)("div",{className:i.A.formRow,children:(0,l.jsxs)("div",{className:i.A.colorPicker,children:[(0,l.jsx)("label",{children:"\u984f\u8272\uff1a"}),(0,l.jsx)("div",{className:i.A.colorOptions,children:c.map(e=>(0,l.jsx)("button",{type:"button",className:`${i.A.colorOption} ${n.color===e?i.A.colorSelected:""}`,style:{backgroundColor:e},onClick:()=>d(t=>({...t,color:e})),title:e},e))})]})}),(0,l.jsxs)("div",{className:i.A.formActions,children:[(0,l.jsx)("button",{type:"submit",className:i.A.submitBtn,children:u?"\u66f4\u65b0":"\u65b0\u589e"}),u&&(0,l.jsx)("button",{type:"button",onClick:()=>{m(null),d({id:"",content:"",tags:"",color:c[0]})},className:i.A.cancelBtn,children:"\u53d6\u6d88"})]})]}),(0,l.jsxs)("div",{className:i.A.tagsSection,children:[(0,l.jsx)("h3",{className:i.A.sectionTitle,children:"\u6a19\u7c64"}),(0,l.jsxs)("div",{className:i.A.tagsList,children:[(0,l.jsx)("button",{className:`${i.A.tagButton} ${""===p?i.A.tagButtonActive:""}`,onClick:()=>A(""),children:"\u5168\u90e8"}),N.map(e=>(0,l.jsx)("button",{className:`${i.A.tagButton} ${p===e?i.A.tagButtonActive:""}`,onClick:()=>A(e),children:e},e))]})]}),(0,l.jsxs)("div",{className:i.A.filterSection,children:[(0,l.jsx)("h3",{className:i.A.sectionTitle,children:"\u7be9\u9078"}),(0,l.jsx)("input",{type:"text",placeholder:"\u95dc\u9375\u5b57\u641c\u5c0b...",value:h,onChange:e=>g(e.target.value),className:i.A.searchInput}),(0,l.jsxs)("select",{value:f,onChange:e=>x(e.target.value),className:i.A.timeSelect,children:[(0,l.jsx)("option",{value:"ALL",children:"\u5168\u90e8\u6642\u9593"}),(0,l.jsx)("option",{value:"TODAY",children:"\u4eca\u5929"}),(0,l.jsx)("option",{value:"WEEK",children:"\u8fd1\u4e00\u9031"}),(0,l.jsx)("option",{value:"MONTH",children:"\u8fd1\u4e00\u6708"}),(0,l.jsx)("option",{value:"QUARTER",children:"\u8fd1\u4e00\u5b63"}),(0,l.jsx)("option",{value:"YEAR",children:"\u8fd1\u4e00\u5e74"})]}),(0,l.jsxs)("div",{className:i.A.filterInfo,children:["\u986f\u793a ",_.length," / ",e.length," \u5f35"]})]})]}),b&&(0,l.jsx)("div",{className:i.A.overlay,onClick:()=>j(null)}),(0,l.jsx)("div",{className:i.A.rightContent,children:(0,l.jsx)("div",{className:i.A.notesGrid,children:0===_.length?(0,l.jsx)("div",{className:i.A.emptyState,children:0===e.length?"\u9084\u6c92\u6709\u4fbf\u5229\u8cbc\uff0c\u5efa\u7acb\u7b2c\u4e00\u5f35\u5427\uff01":"\u6c92\u6709\u5339\u914d\u7684\u4fbf\u5229\u8cbc"}):_.map(t=>(0,l.jsxs)("div",{className:`${i.A.note} ${b===t.id?i.A.noteExpanded:""}`,style:{backgroundColor:t.color||c[0]},onClick:e=>{e.stopPropagation(),j(b===t.id?null:t.id)},children:[(0,l.jsxs)("div",{className:i.A.noteHeader,children:[(0,l.jsx)("span",{className:i.A.noteTime,children:w(t.createdAt)}),(0,l.jsxs)("div",{className:i.A.noteActions,children:[(0,l.jsx)("button",{onClick:e=>{e.stopPropagation(),(e=>{d({id:e.id,content:e.content,tags:e.tags||"",color:e.color||c[0]}),m(e.id)})(t)},className:i.A.editBtn,title:"\u7de8\u8f2f",children:"\u270e"}),(0,l.jsx)("button",{onClick:n=>{n.stopPropagation(),(t=>{if(window.confirm("\u78ba\u5b9a\u8981\u522a\u9664\u9019\u5f35\u4fbf\u5229\u8cbc\u55ce\uff1f")){const n=e.filter(e=>e.id!==t);v(n)}})(t.id)},className:i.A.deleteBtn,title:"\u522a\u9664",children:"\u2715"})]})]}),(0,l.jsx)("div",{className:i.A.noteContent,children:C(t.content,h)}),t.tags&&(0,l.jsx)("div",{className:i.A.noteTags,children:t.tags.split(/\s+/).filter(e=>e).map((e,t)=>{const n=C(e,h);return(0,l.jsx)("span",{className:i.A.tag,children:n},t)})}),(0,l.jsx)("button",{onClick:n=>{n.stopPropagation(),(t=>{const n=e.map(e=>e.id===t?{...e,completed:!0,completedAt:Date.now()}:e);v(n)})(t.id)},className:i.A.completeBtn,title:"\u6a19\u8a18\u70ba\u5b8c\u6210",children:"\u2713"})]},t.id))})})]})]})}},2294:(e,t,n)=>{n.d(t,{FO:()=>u,_Z:()=>c,bY:()=>d});var o=n(223),s=n(8185),a=n(7673),r=n(8193);const i=(0,o.Dk)().length?(0,o.Sx)():(0,o.Wp)({apiKey:"AIzaSyAUDHCT_dtMHQFPcUh6-gFSIFXT6dR9MVg",authDomain:"my-tools-1228.firebaseapp.com",projectId:"my-tools-1228",storageBucket:"my-tools-1228.firebasestorage.app",messagingSenderId:"511787460330",appId:"1:511787460330:web:2896507029051b666e5993",measurementId:"G-WFF13TV61G"}),l=(0,s._A)(i,{experimentalForceLongPolling:!0,useFetchStreams:!1}),c=(0,s.rJ)(l,"stockWatchlist"),d=(0,s.H9)(l,"trade_journals","my_only_log"),u=(0,s.H9)(l,"whiteboard","my_whiteboard");let m;r.A.canUseDOM&&(m=(0,a.P5)(i))},5629:(e,t,n)=>{n.d(t,{A:()=>o});const o={whiteboardContainer:"whiteboardContainer_SP8X",mainLayout:"mainLayout_s6_7",leftSidebar:"leftSidebar_jF0t",rightContent:"rightContent_uNkw",sectionTitle:"sectionTitle_bN4F",tagsSection:"tagsSection_d2gX",tagsList:"tagsList_uoeT",tagButton:"tagButton_Bnu4",tagButtonActive:"tagButtonActive_nT5x",filterSection:"filterSection_L1uU",searchInput:"searchInput_nHte",timeSelect:"timeSelect_Epza",filterInfo:"filterInfo_L1cn",formContainer:"formContainer_jEvc",formRow:"formRow_LGGj",contentInput:"contentInput_cgkr",tagsInput:"tagsInput_NCNq",colorPicker:"colorPicker_l25W",colorOptions:"colorOptions_zfKP",colorOption:"colorOption_CQd9",colorSelected:"colorSelected_kIwL",formActions:"formActions_PXo5",submitBtn:"submitBtn_PNCW",cancelBtn:"cancelBtn_Pbfg",notesGrid:"notesGrid_M4Tb",note:"note_53F0",noteExpanded:"noteExpanded_qeKQ",overlay:"overlay_FoWT",noteHeader:"noteHeader_ooKq",noteTime:"noteTime_tDhb",noteActions:"noteActions_vMqJ",editBtn:"editBtn_KWIG",deleteBtn:"deleteBtn_zWTc",completeBtn:"completeBtn_nfHb",noteContent:"noteContent_o38U",noteTags:"noteTags_GCXa",tag:"tag_Qk_f",highlight:"highlight_graa",emptyState:"emptyState_sO56",completedBtn:"completedBtn_ezVy",backBtn:"backBtn_UIqj",completedNote:"completedNote_GkBB"}},8478:(e,t,n)=>{n.d(t,{A:()=>a});n(6540);var o=n(2303),s=n(4848);function a({children:e,fallback:t}){return(0,o.A)()?(0,s.jsx)(s.Fragment,{children:e?.()}):t??null}},9361:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});n(6540);var o=n(1656),s=n(8478),a=n(4848);function r(){return(0,a.jsx)(o.A,{title:"\u767d\u677f",description:"\u4fbf\u5229\u8cbc\u767d\u677f - \u8a18\u9304\u548c\u7ba1\u7406\u4f60\u7684\u60f3\u6cd5",children:(0,a.jsx)(s.A,{fallback:(0,a.jsx)("div",{children:"\u8f09\u5165\u767d\u677f\u4e2d..."}),children:()=>{const e=n(862).A;return(0,a.jsx)(e,{})}})})}},9410:(e,t,n)=>{n.d(t,{A:()=>c});const o={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let s;const a=new Uint8Array(16);const r=[];for(let d=0;d<256;++d)r.push((d+256).toString(16).slice(1));function i(e,t=0){return(r[e[t+0]]+r[e[t+1]]+r[e[t+2]]+r[e[t+3]]+"-"+r[e[t+4]]+r[e[t+5]]+"-"+r[e[t+6]]+r[e[t+7]]+"-"+r[e[t+8]]+r[e[t+9]]+"-"+r[e[t+10]]+r[e[t+11]]+r[e[t+12]]+r[e[t+13]]+r[e[t+14]]+r[e[t+15]]).toLowerCase()}function l(e,t,n){const o=(e=e||{}).random??e.rng?.()??function(){if(!s){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");s=crypto.getRandomValues.bind(crypto)}return s(a)}();if(o.length<16)throw new Error("Random bytes length must be >= 16");if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){if((n=n||0)<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=o[e];return t}return i(o)}const c=function(e,t,n){return!o.randomUUID||t||e?l(e,t,n):o.randomUUID()}}}]);